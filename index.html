<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM Prospecção - Silva Tintas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Estilo para a barra de rolagem */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Transições suaves */
        .view {
            transition: opacity 0.5s ease-in-out;
        }
        .hidden-view {
            opacity: 0;
            pointer-events: none;
            position: absolute;
            width: 100%;
        }
        .visible-view {
            opacity: 1;
            position: relative;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div id="login-view" class="view visible-view min-h-screen flex items-center justify-center p-4">
        <div class="w-full max-w-sm bg-white p-8 rounded-xl shadow-lg">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-700">Silva Tintas</h1>
                <p class="text-gray-500">CRM de Prospecção</p>
            </div>
            <form id="login-form">
                <div class="mb-4">
                    <label for="username" class="block text-sm font-medium text-gray-700 mb-1">Login</label>
                    <input type="text" id="username" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <div class="mb-6">
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Senha</label>
                    <input type="password" id="password" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300">Entrar</button>
                <p id="login-error" class="text-red-500 text-sm text-center mt-4"></p>
            </form>
        </div>
    </div>

    <div id="crm-view" class="view hidden-view">
        <div class="container mx-auto p-4 md:p-8">

            <header class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
                <div>
                    <h1 class="text-3xl font-bold text-gray-700">CRM Silva Tintas</h1>
                    <p id="welcome-message" class="text-gray-500">Bem-vindo!</p>
                </div>
                <div class="flex items-center space-x-2 md:space-x-4">
                    <div class="text-center">
                        <span id="client-count" class="text-2xl font-bold text-blue-600">0</span>
                        <p class="text-sm text-gray-500">Clientes</p>
                    </div>
                    <button id="add-client-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 text-sm">
                        + Adicionar Cliente
                    </button>
                    <button id="logout-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300">
                        Sair
                    </button>
                </div>
            </header>
            
            <div class="mb-8">
                <input type="text" id="search-bar" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Pesquisar por empresa, endereço, vendedor...">
            </div>

            <section id="admin-dashboard" class="mb-8 hidden">
                <h2 class="text-2xl font-bold text-gray-700 mb-4">Dashboard do Administrador</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 bg-white p-4 rounded-lg shadow">
                    <div>
                        <label for="filter-category" class="block text-sm font-medium text-gray-700">Filtrar por Categoria</label>
                        <select id="filter-category" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            <option value="todos">Todas as Categorias</option>
                            <option value="Funilaria">Funilaria</option>
                            <option value="Estetica Automotiva">Estética Automotiva</option>
                            <option value="Marcenaria">Marcenaria</option>
                            <option value="Industria">Indústria</option>
                            <option value="Fabrica">Fábrica</option>
                            <option value="Usina">Usina</option>
                            <option value="Car Detailing">Car Detailing</option>
                        </select>
                    </div>
                    <div>
                        <label for="filter-seller" class="block text-sm font-medium text-gray-700">Filtrar por Vendedor</label>
                        <select id="filter-seller" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            <option value="todos">Todos os Vendedores</option>
                            </select>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-white p-4 rounded-lg shadow-md flex flex-col items-center">
                        <h3 class="font-semibold text-gray-600 mb-2">Taxa de Conversão</h3>
                        <div class="w-full h-64"><canvas id="conversionChart"></canvas></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-md flex flex-col items-center">
                        <h3 class="font-semibold text-gray-600 mb-2">Clientes por Categoria</h3>
                        <div class="w-full h-64"><canvas id="categoryChart"></canvas></div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-md flex flex-col items-center">
                        <h3 class="font-semibold text-gray-600 mb-2">Clientes por Vendedor</h3>
                        <div class="w-full h-64"><canvas id="sellerChart"></canvas></div>
                    </div>
                </div>
            </section>
            
            <main id="client-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                </main>
        </div>
    </div>

    <div id="client-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-2xl p-8 w-full max-w-md">
            <h2 id="modal-title" class="text-2xl font-bold mb-6">Adicionar Novo Cliente</h2>
            <form id="client-form">
                <div class="mb-4">
                    <label for="empresa" class="block text-sm font-medium text-gray-700 mb-1">Empresa*</label>
                    <input type="text" id="empresa" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <div class="mb-4">
                    <label for="endereco" class="block text-sm font-medium text-gray-700 mb-1">Endereço*</label>
                    <input type="text" id="endereco" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="telefone" class="block text-sm font-medium text-gray-700 mb-1">Telefone</label>
                        <input type="tel" id="telefone" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input type="email" id="email" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
                <div class="mb-4">
                    <label for="vendedor" class="block text-sm font-medium text-gray-700 mb-1">Vendedor Responsável</label>
                    <input type="text" id="vendedor" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div class="mb-6">
                    <label for="categoria" class="block text-sm font-medium text-gray-700 mb-1">Categoria*</label>
                    <select id="categoria" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                        <option value="Funilaria">Funilaria</option>
                        <option value="Estetica Automotiva">Estética Automotiva</option>
                        <option value="Marcenaria">Marcenaria</option>
                        <option value="Industria">Indústria</option>
                        <option value="Fabrica">Fábrica</option>
                        <option value="Usina">Usina</option>
                        <option value="Car Detailing">Car Detailing</option>
                    </select>
                </div>
                <div class="flex justify-end space-x-4">
                    <button type="button" id="cancel-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg transition duration-300">Cancelar</button>
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <script type="module">
        // Importações do Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-analytics.js";

        // --- Configuração e Inicialização ---
        const firebaseConfig = {
            apiKey: "AIzaSyDPisgGzruxqnXzf9hPlb05uCN3hMozt2s",
            authDomain: "crm-silva-tintas.firebaseapp.com",
            projectId: "crm-silva-tintas",
            storageBucket: "crm-silva-tintas.firebasestorage.app",
            messagingSenderId: "37152653096",
            appId: "1:37152653096:web:37e27f33544fdc36abda1d",
            measurementId: "G-Y4EXZKNN2F"
        };
        
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- Variáveis de Estado ---
        let currentUserId = null;
        let currentUserRole = null; 
        let unsubscribeFromClients = null;
        let editingClientId = null;
        let allClientsData = []; 
        let conversionChartInstance, categoryChartInstance, sellerChartInstance;

        // --- Elementos do DOM ---
        const loginView = document.getElementById('login-view');
        const crmView = document.getElementById('crm-view');
        const loginForm = document.getElementById('login-form');
        const loginError = document.getElementById('login-error');
        const logoutBtn = document.getElementById('logout-btn');
        const welcomeMessage = document.getElementById('welcome-message');
        const adminDashboard = document.getElementById('admin-dashboard');
        const clientList = document.getElementById('client-list');
        const clientCount = document.getElementById('client-count');
        const addClientBtn = document.getElementById('add-client-btn');
        const clientModal = document.getElementById('client-modal');
        const modalTitle = document.getElementById('modal-title');
        const cancelBtn = document.getElementById('cancel-btn');
        const clientForm = document.getElementById('client-form');
        const searchBar = document.getElementById('search-bar');
        const filterCategory = document.getElementById('filter-category');
        const filterSeller = document.getElementById('filter-seller');

        // --- Lógica de Autenticação e Login ---
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                currentUserId = user.uid;
                loginError.textContent = ""; 
            } else {
                try {
                    loginError.textContent = "Conectando...";
                    await signInAnonymously(auth);
                } catch (error) {
                    console.error("Falha ao conectar com o Firebase:", error);
                    loginError.textContent = "Erro de conexão. Verifique a internet.";
                }
            }
        });

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            if (!currentUserId) {
                loginError.textContent = 'Aguardando conexão... Tente novamente.';
                return; 
            }
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            if ((username === 'Admin' && password === 'Admin') || (username === 'Vendas' && password === 'Vendas')) {
                currentUserRole = (username === 'Admin') ? 'Admin' : 'Vendas';
                showCrmView();
                listenToClients();
            } else {
                loginError.textContent = 'Login ou senha inválidos.';
            }
        });

        logoutBtn.addEventListener('click', () => {
            currentUserRole = null;
            loginError.textContent = '';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            if (unsubscribeFromClients) unsubscribeFromClients();
            showLoginView();
        });

        function showCrmView() {
            loginView.classList.remove('visible-view');
            loginView.classList.add('hidden-view');
            crmView.classList.remove('hidden-view');
            crmView.classList.add('visible-view');
            welcomeMessage.textContent = `Bem-vindo, ${currentUserRole}!`;
            adminDashboard.classList.toggle('hidden', currentUserRole !== 'Admin');
        }

        function showLoginView() {
            crmView.classList.remove('visible-view');
            crmView.classList.add('hidden-view');
            loginView.classList.remove('hidden-view');
            loginView.classList.add('visible-view');
        }

        // --- Lógica do Firestore ---
        const clientsCollectionRef = collection(db, 'clientes');

        function listenToClients() {
            if (unsubscribeFromClients) unsubscribeFromClients();
            
            unsubscribeFromClients = onSnapshot(clientsCollectionRef, (snapshot) => {
                allClientsData = snapshot.docs.map(doc => {
                    const data = doc.data();
                    const criadoEm = data.criadoEm?.toDate ? data.criadoEm.toDate() : new Date();
                    return { id: doc.id, ...data, criadoEmDate: criadoEm };
                });
                allClientsData.sort((a, b) => b.criadoEmDate - a.criadoEmDate);
                
                if (currentUserRole === 'Admin') {
                    populateSellerFilter(allClientsData);
                }
                
                updateMainDisplay();
            }, (error) => {
                console.error("Erro ao buscar clientes:", error);
                clientList.innerHTML = `<p class="text-red-500 col-span-full text-center">Erro ao carregar dados. Verifique as regras de segurança do Firestore.</p>`;
            });
        }
        
        // --- Lógica de Filtros e Renderização ---
        
        searchBar.addEventListener('input', updateMainDisplay);
        filterCategory.addEventListener('change', updateMainDisplay);
        filterSeller.addEventListener('change', updateMainDisplay);

        function updateMainDisplay() {
            let filteredClients = [...allClientsData];
            const searchTerm = searchBar.value.toLowerCase();

            // Aplica filtro de pesquisa
            if (searchTerm) {
                filteredClients = filteredClients.filter(client => 
                    (client.empresa?.toLowerCase() || '').includes(searchTerm) ||
                    (client.endereco?.toLowerCase() || '').includes(searchTerm) ||
                    (client.vendedor?.toLowerCase() || '').includes(searchTerm)
                );
            }

            // Aplica filtros do Admin
            if (currentUserRole === 'Admin') {
                const selectedCategory = filterCategory.value;
                const selectedSeller = filterSeller.value;

                if (selectedCategory !== 'todos') {
                    filteredClients = filteredClients.filter(c => c.categoria === selectedCategory);
                }
                if (selectedSeller !== 'todos') {
                    filteredClients = filteredClients.filter(c => (c.vendedor || 'Não atribuído') === selectedSeller);
                }
                renderAdminDashboard(filteredClients);
            }
            
            renderClientList(filteredClients);
        }

        function renderClientList(clients) {
            clientList.innerHTML = '';
            clientCount.textContent = clients.length;

            if (clients.length === 0) {
                clientList.innerHTML = `<p class="text-gray-500 col-span-full text-center mt-8">Nenhum cliente encontrado.</p>`;
                return;
            }
            clients.forEach(client => {
                const clientCard = createClientCard(client.id, client);
                clientList.appendChild(clientCard);
            });
        }

        function populateSellerFilter(clients) {
            const sellers = [...new Set(clients.map(c => c.vendedor || 'Não atribuído').filter(Boolean))];
            filterSeller.innerHTML = '<option value="todos">Todos os Vendedores</option>';
            sellers.sort().forEach(seller => {
                const option = document.createElement('option');
                option.value = seller;
                option.textContent = seller;
                filterSeller.appendChild(option);
            });
        }

        function renderAdminDashboard(clients) {
            // Destroi gráficos antigos para evitar sobreposição
            if(conversionChartInstance) conversionChartInstance.destroy();
            if(categoryChartInstance) categoryChartInstance.destroy();
            if(sellerChartInstance) sellerChartInstance.destroy();

            // 1. Gráfico de Conversão
            const convertedCount = clients.filter(c => c.status === 'Cliente').length;
            const notConvertedCount = clients.length - convertedCount;
            conversionChartInstance = new Chart(document.getElementById('conversionChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Clientes Convertidos', 'Em Prospecção'],
                    datasets: [{
                        data: [convertedCount, notConvertedCount],
                        backgroundColor: ['#10B981', '#6B7280'],
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });

            // 2. Gráfico de Categoria
            const categoryCounts = clients.reduce((acc, client) => {
                acc[client.categoria] = (acc[client.categoria] || 0) + 1;
                return acc;
            }, {});
            categoryChartInstance = new Chart(document.getElementById('categoryChart'), {
                type: 'doughnut',
                data: {
                    labels: Object.keys(categoryCounts),
                    datasets: [{
                        data: Object.values(categoryCounts),
                        backgroundColor: ['#8B5CF6', '#F59E0B', '#EF4444', '#6B7280', '#3B82F6', '#14B8A6'],
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });

            // 3. Gráfico de Vendedor
            const sellerCounts = clients.reduce((acc, client) => {
                const sellerName = client.vendedor || 'Não atribuído';
                acc[sellerName] = (acc[sellerName] || 0) + 1;
                return acc;
            }, {});
            sellerChartInstance = new Chart(document.getElementById('sellerChart'), {
                type: 'doughnut',
                data: {
                    labels: Object.keys(sellerCounts),
                    datasets: [{
                        data: Object.values(sellerCounts),
                        backgroundColor: ['#3B82F6', '#10B981', '#F97316', '#8B5CF6', '#D946EF'],
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });
        }
        
        // --- Lógica do Modal e CRUD ---
        function openModalForEdit(clientId) {
            const clientData = allClientsData.find(c => c.id === clientId);
            if (!clientData) return;

            editingClientId = clientId;
            modalTitle.textContent = "Editar Cliente";
            document.getElementById('empresa').value = clientData.empresa || '';
            document.getElementById('endereco').value = clientData.endereco || '';
            document.getElementById('telefone').value = clientData.telefone || '';
            document.getElementById('email').value = clientData.email || '';
            document.getElementById('vendedor').value = clientData.vendedor || '';
            document.getElementById('categoria').value = clientData.categoria || 'Funilaria';
            
            clientModal.classList.remove('hidden');
        }

        addClientBtn.addEventListener('click', () => {
            editingClientId = null;
            modalTitle.textContent = "Adicionar Novo Cliente";
            clientForm.reset();
            clientModal.classList.remove('hidden');
        });

        cancelBtn.addEventListener('click', () => {
            clientModal.classList.add('hidden');
            clientForm.reset();
        });
        
        clientModal.addEventListener('click', (e) => {
            if (e.target === clientModal) {
                 clientModal.classList.add('hidden');
                 clientForm.reset();
            }
        });

        clientForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const clientData = {
                empresa: document.getElementById('empresa').value.trim(),
                endereco: document.getElementById('endereco').value.trim(),
                telefone: document.getElementById('telefone').value.trim(),
                email: document.getElementById('email').value.trim(),
                vendedor: document.getElementById('vendedor').value.trim(),
                categoria: document.getElementById('categoria').value,
            };
            try {
                if (editingClientId) {
                    const clientDocRef = doc(db, 'clientes', editingClientId);
                    await updateDoc(clientDocRef, clientData);
                } else {
                    await addDoc(clientsCollectionRef, { ...clientData, status: 'Não contatado', criadoEm: new Date(), criadoPor: currentUserId });
                }
                clientModal.classList.add('hidden');
                clientForm.reset();
                editingClientId = null;
            } catch (error) {
                console.error("Erro ao salvar cliente:", error);
            }
        });

        async function updateClientStatus(id, newStatus) {
            const clientDocRef = doc(db, 'clientes', id);
            await updateDoc(clientDocRef, { status: newStatus });
        }

        async function deleteClient(id) {
            const clientDocRef = doc(db, 'clientes', id);
            await deleteDoc(clientDocRef);
        }
        
        clientList.addEventListener('click', (e) => {
            const editButton = e.target.closest('.edit-btn');
            const deleteButton = e.target.closest('.delete-btn');
            
            if (editButton) {
                openModalForEdit(editButton.dataset.id);
            }
            
            if (deleteButton) {
                if (confirm('Tem certeza que deseja excluir este cliente?')) {
                     deleteClient(deleteButton.dataset.id);
                }
            }
        });

        // --- Criação do Card do Cliente (UI) ---
        function createClientCard(id, data) {
            const card = document.createElement('div');
            card.className = 'bg-white rounded-lg shadow-md p-5 flex flex-col justify-between transition-transform transform hover:-translate-y-1';
            const categoryColors = {
                'Funilaria': 'bg-purple-100 text-purple-800', 
                'Estetica Automotiva': 'bg-teal-100 text-teal-800', 
                'Marcenaria': 'bg-yellow-100 text-yellow-800', 
                'Industria': 'bg-red-100 text-red-800', 
                'Fabrica': 'bg-indigo-100 text-indigo-800',
                'Usina': 'bg-gray-200 text-gray-800',
                'Car Detailing': 'bg-blue-100 text-blue-800'
            };
            const statusColors = { 'Não contatado': 'bg-gray-200 text-gray-800', 'Contatado': 'bg-blue-200 text-blue-800', 'Em negociação': 'bg-yellow-200 text-yellow-800', 'Cliente': 'bg-green-200 text-green-800' };
            const statusOptions = ['Não contatado', 'Contatado', 'Em negociação', 'Cliente'];
            card.innerHTML = `
                <div>
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="text-lg font-bold text-gray-900 pr-2">${data.empresa}</h3>
                        <span class="text-xs font-semibold px-2 py-1 rounded-full ${categoryColors[data.categoria] || 'bg-gray-100'}">${data.categoria}</span>
                    </div>
                    <p class="text-sm text-gray-600 mb-1"><span class="font-semibold">Endereço:</span> ${data.endereco || 'Não informado'}</p>
                    ${data.telefone ? `<p class="text-sm text-gray-600 mb-1"><span class="font-semibold">Telefone:</span> ${data.telefone}</p>` : ''}
                    ${data.email ? `<p class="text-sm text-gray-600 mb-1"><span class="font-semibold">Email:</span> ${data.email}</p>` : ''}
                    <p class="text-sm text-gray-600 mb-4"><span class="font-semibold">Vendedor:</span> ${data.vendedor || 'Não atribuído'}</p>
                </div>
                <div class="mt-auto pt-4 border-t border-gray-200">
                    <div class="flex justify-between items-center">
                         <select class="status-select w-full text-sm font-semibold p-2 rounded-md border-gray-300 focus:ring-blue-500 focus:border-blue-500 ${statusColors[data.status]}">
                             ${statusOptions.map(opt => `<option value="${opt}" ${opt === data.status ? 'selected' : ''}>${opt}</option>`).join('')}
                         </select>
                         <div class="flex items-center ml-3">
                             <button class="edit-btn text-gray-400 hover:text-blue-600 transition duration-300 mr-2" data-id="${id}">
                                 <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                   <path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L16.732 3.732z" />
                                 </svg>
                             </button>
                             <button class="delete-btn text-gray-400 hover:text-red-600 transition duration-300" data-id="${id}">
                                 <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                 </svg>
                             </button>
                         </div>
                    </div>
                </div>
            `;
            card.querySelector('.status-select').addEventListener('change', (e) => updateClientStatus(id, e.target.value));
            return card;
        }
    </script>
</body>
</html>
